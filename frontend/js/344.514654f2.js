"use strict";(globalThis["webpackChunknexar_xm"]=globalThis["webpackChunknexar_xm"]||[]).push([[344],{63344:(e,t,a)=>{a.r(t),a.d(t,{default:()=>qt});var o=a(59835),l=a(86970);const s={class:"full-width row inline wrap justify-start items-start content-start"},r={key:0,class:"backdiv"},n={class:"absolute-top"},i={key:1,class:"col-grow q-mr-xl q-mt-lg text-center",style:{height:"80vh"}},m={class:"row q-mt-xl"},d={class:"col q-mx-auto text-center"},c={class:"col"};function u(e,t,a,u,p,x){const g=(0,o.up)("q-icon"),h=(0,o.up)("upload-files"),v=(0,o.up)("exames-laudados"),f=(0,o.up)("exames-enviados"),w=(0,o.up)("exames-repetir"),E=(0,o.up)("q-page");return(0,o.wg)(),(0,o.j4)(E,{padding:""},{default:(0,o.w5)((()=>[(0,o._)("div",s,[u.showDiv?((0,o.wg)(),(0,o.iD)("div",r)):(0,o.kq)("",!0),(0,o._)("div",n,[(0,o.Wm)(g,{style:{cursor:"pointer"},size:"md",name:u.showDiv?"toggle_on":"toggle_off",class:"float-left q-mx-lg q-my-xs",onClick:t[0]||(t[0]=e=>u.toggleDiv())},null,8,["name"])]),(0,o._)("div",{class:(0,l.C_)([e.$q.platform.is.desktop?"col-3":"col","text-center"])},[((0,o.wg)(),(0,o.j4)(h,{class:"q-mx-auto q-my-auto",key:u.upcount})),e.$q.platform.is.mobile?((0,o.wg)(),(0,o.j4)(v,{key:0,class:"q-mx-auto center q-mx-auto q-mt-md"})):(0,o.kq)("",!0),(0,o.Wm)(f,{class:"center q-mx-auto q-mt-md"})],2),e.$q.platform.is.desktop?((0,o.wg)(),(0,o.iD)("div",i,[(0,o._)("div",{class:(0,l.C_)([u.showDiv?"text-white":"text-dark","text-h4 no-padding absolute-right text-weight-light"]),style:{"margin-right":"10vw","margin-top":"32px"}},(0,l.zw)(x.today),3),(0,o._)("div",m,[(0,o._)("div",d,[(0,o.Wm)(w,{class:"q-mx-auto"})]),(0,o._)("div",c,[(0,o.Wm)(v,{class:"q-mx-auto"})])])])):(0,o.kq)("",!0)])])),_:1})}var p=a(60499),x=a(43878),g=a.n(x),h=a(28370);const v=e=>((0,o.dD)("data-v-0d326ecd"),e=e(),(0,o.Cn)(),e),f={class:"myCard dropzone text-dark",id:"dropzone"},w={class:"dz-message absolute-centers"},E=v((()=>(0,o._)("div",{class:"text-caption text-primary",style:{"line-height":"96%"}},[(0,o.Uk)(" Clique ou arraste seu"),(0,o._)("br"),(0,o.Uk)("exame aqui para enviar! ")],-1))),y={class:"text-h5 text-dark text-weight-light text-center"},_=(0,o.Uk)(" Dados do Paciente "),b={class:"float-right"},k={class:"row full-width q-gutter-md wrap"},q={class:"col"},I={class:"col"},C={class:"fit row wrap justify-start items-start content-start q-gutter-sm"},S={class:"col-4 justify-left"},D=v((()=>(0,o._)("div",{class:"text-subtitle2 text-dark"},"anos",-1))),$=v((()=>(0,o._)("div",{class:"col-shrink justify-left q-my-auto"},"OU",-1))),T={class:"col-5"},W={class:"row full-width justify-around q-mb-md"},P={class:"row full-width q-gutter-sm"},O={class:"col"},U={class:"col text-center justify-center"},Z={class:"col"},j=v((()=>(0,o._)("div",{class:"row full-width text-subtitle1 text-weight-light text-dark q-mt-md",style:{"line-height":"96%"}},[(0,o._)("div",{class:"offset-1"},[(0,o.Uk)(" Motivo(s) para o exame"),(0,o._)("br"),(0,o._)("span",{class:"text-weight-light text-caption no-padding"},"Por favor, informe o(s) motivo(s) para o exame.")])],-1))),M={class:"text-h5 text-dark text-weight-light text-center"},V=(0,o.Uk)(" Dados do Paciente "),H={class:"float-right"},N=v((()=>(0,o._)("div",{class:"text-h5 justify-center text-center"}," FORMULÁRIO DO EEG ",-1))),R={class:"text-h5 text-dark text-weight-light text-center"},A=(0,o.Uk)(" Dados do Paciente "),L={class:"float-right"},F=v((()=>(0,o._)("div",{class:"text-h5 justify-center text-center"}," FORMULÁRIO DE DERMATOSCOPIA DIGITAL ",-1)));function z(e,t,a,s,r,n){const i=(0,o.up)("q-icon"),m=(0,o.up)("q-card-section"),d=(0,o.up)("q-input"),c=(0,o.up)("q-option-group"),u=(0,o.up)("q-select"),p=(0,o.up)("q-form"),x=(0,o.up)("q-separator"),g=(0,o.up)("q-toggle"),h=(0,o.up)("q-btn"),v=(0,o.up)("q-card-actions"),z=(0,o.up)("q-card"),Q=(0,o.up)("q-dialog");return(0,o.wg)(),(0,o.iD)("div",f,[(0,o._)("div",w,[(0,o.Wm)(i,{name:"cloud_upload",color:"primary",size:"96px"}),E,(0,o.Wm)(Q,{modelValue:s.dlgExam,"onUpdate:modelValue":t[22]||(t[22]=e=>s.dlgExam=e),persistent:"","transition-show":"scale","transition-hide":"scale",maximized:!!e.$q.platform.is.mobile},{default:(0,o.w5)((()=>["ECG"==s.sendExamType?((0,o.wg)(),(0,o.j4)(z,{key:0,class:(0,l.C_)([e.$q.platform.is.desktop?"frmDlg":"","dlgUpload"])},{default:(0,o.w5)((()=>[(0,o.Wm)(m,null,{default:(0,o.w5)((()=>[(0,o._)("div",y,[_,(0,o._)("div",b,[(0,o.Wm)(i,{class:(0,l.C_)(s.readOnlyInfo?"text-primary":"text-dark"),name:s.readOnlyInfo?"lock":"lock_open",onClick:t[0]||(t[0]=e=>s.readOnlyInfo=!s.readOnlyInfo),style:{cursor:"pointer"},title:"Editar informações"},null,8,["class","name"])])])])),_:1}),(0,o.Wm)(m,null,{default:(0,o.w5)((()=>[(0,o.Wm)(p,{class:"text-dark q-mx-sm"},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{readonly:s.readOnlyInfo,outlined:"",dense:"",modelValue:s.newExam.nome,"onUpdate:modelValue":t[1]||(t[1]=e=>s.newExam.nome=e),label:"Nome do Paciente *",class:"text-uppercase","lazy-rules":"",rules:[e=>e&&e.length>0||"Por favor digite algo"]},null,8,["readonly","modelValue","rules"]),(0,o._)("div",k,[(0,o._)("div",q,[(0,o.Wm)(d,{outlined:"",dense:"",modelValue:s.newExam.register,"onUpdate:modelValue":t[2]||(t[2]=e=>s.newExam.register=e),label:"Registro do Paciente"},null,8,["modelValue"])]),(0,o._)("div",I,[(0,o.Wm)(d,{readonly:s.readOnlyInfo,outlined:"",dense:"","unmasked-value":"",modelValue:s.newExam.cpf,"onUpdate:modelValue":t[3]||(t[3]=e=>s.newExam.cpf=e),label:"CPF do Paciente","lazy-rules":"",mask:"###.###.###-##",rules:[e=>s.testarCPF(e)||"CPF inválido"]},null,8,["readonly","modelValue","rules"])])]),(0,o._)("div",C,[(0,o._)("div",S,[(0,o.Wm)(d,{readonly:s.readOnlyInfo,outlined:"",dense:"",type:"number",modelValue:s.newExam.age,"onUpdate:modelValue":t[4]||(t[4]=e=>s.newExam.age=e),label:"Idade","lazy-rules":"",rules:[e=>null!==e&&""!==e||"Por favor digite a idade",e=>e>0&&e<100||"Por favor digite uma idade factível."]},(0,o.Nv)({_:2},[e.$q.platform.is.desktop?{name:"append",fn:(0,o.w5)((()=>[D]))}:void 0]),1032,["readonly","modelValue","rules"])]),$,(0,o._)("div",T,[(0,o.Wm)(d,{readonly:s.readOnlyInfo,outlined:"",dense:"",modelValue:s.newExam.nascimento,"onUpdate:modelValue":t[5]||(t[5]=e=>s.newExam.nascimento=e),label:"Data de Nascimento",mask:"##-##-####"},null,8,["readonly","modelValue"])]),(0,o._)("div",W,[(0,o.Wm)(c,{inline:"",size:"xs",disable:s.readOnlyInfo,modelValue:s.newExam.sexo,"onUpdate:modelValue":t[6]||(t[6]=e=>s.newExam.sexo=e),options:s.sexOptions,color:"primary",dense:""},null,8,["disable","modelValue","options"])])]),(0,o._)("div",P,[(0,o._)("div",O,[(0,o.Wm)(d,{outlined:"",dense:"",modelValue:s.newExam.email,"onUpdate:modelValue":t[7]||(t[7]=e=>s.newExam.email=e),label:"Email do Paciente"},null,8,["modelValue"])]),(0,o._)("div",U,[(0,o._)("div",Z,[(0,o.Wm)(d,{outlined:"",dense:"",modelValue:s.newExam.phone,"onUpdate:modelValue":t[8]||(t[8]=e=>s.newExam.phone=e),label:"Telefone do Paciente"},null,8,["modelValue"])])])]),j,(0,o.Wm)(u,{class:"text-dark s-box full-width",outlined:"",dense:"",modelValue:s.newExam.exam_motive,"onUpdate:modelValue":t[9]||(t[9]=e=>s.newExam.exam_motive=e),"use-input":"","use-chips":"",multiple:"","input-debounce":"0",onNewValue:s.createValue,options:s.filterOptions,onFilter:s.filterFn,style:{width:"80%"}},null,8,["modelValue","onNewValue","options","onFilter"]),(0,o.Wm)(d,{class:"q-mt-md text-dark",outlined:"",dense:"",modelValue:s.newExam.obs,"onUpdate:modelValue":t[10]||(t[10]=e=>s.newExam.obs=e),label:"Observações"},null,8,["modelValue"])])),_:1})])),_:1}),(0,o.Wm)(x),(0,o.Wm)(v,{align:"center",class:"q-mr-lg",style:{top:"-5px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(g,{modelValue:s.newExam.urgente,"onUpdate:modelValue":t[11]||(t[11]=e=>s.newExam.urgente=e),label:"Exame Urgente",class:(0,l.C_)(["float-left q-mr-lg text-dark",s.newExam.urgente?"text-red":"text-dark"]),color:s.newExam.urgente?"red":"dark"},null,8,["modelValue","color","class"]),(0,o.Wm)(h,{flat:"",color:"primary",label:"Cancelar",onClick:t[12]||(t[12]=e=>s.cancelExam())}),(0,o.Wm)(h,{disable:0==s.newExam.exam_motive.length||0==s.newExam.nome.length,flat:"",color:0==s.newExam.exam_motive.length||0==s.newExam.nome.length?"secondary":"primary",label:"Enviar",onClick:t[13]||(t[13]=e=>s.sendExam())},null,8,["disable","color"])])),_:1})])),_:1},8,["class"])):(0,o.kq)("",!0),"EEG"==s.sendExamType?((0,o.wg)(),(0,o.j4)(z,{key:1,class:(0,l.C_)(e.$q.platform.is.desktop?"frmDlg":"")},{default:(0,o.w5)((()=>[(0,o.Wm)(m,null,{default:(0,o.w5)((()=>[(0,o._)("div",M,[V,(0,o._)("div",H,[(0,o.Wm)(i,{class:(0,l.C_)(s.readOnlyInfo?"text-primary":"text-dark"),name:s.readOnlyInfo?"lock":"lock_open",onClick:t[14]||(t[14]=e=>s.readOnlyInfo=!s.readOnlyInfo),style:{cursor:"pointer"},title:"Editar informações"},null,8,["class","name"])])])])),_:1}),(0,o.Wm)(m,null,{default:(0,o.w5)((()=>[N])),_:1}),(0,o.Wm)(x),(0,o.Wm)(v,{align:"center",class:"q-mr-lg",style:{top:"-5px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(g,{modelValue:s.newExam.urgente,"onUpdate:modelValue":t[15]||(t[15]=e=>s.newExam.urgente=e),label:"Exame Urgente",class:(0,l.C_)(["float-left q-mr-lg text-dark",s.newExam.urgente?"text-red":"text-dark"]),color:s.newExam.urgente?"red":"dark"},null,8,["modelValue","color","class"]),(0,o.Wm)(h,{flat:"",color:"primary",label:"Cancelar",onClick:t[16]||(t[16]=e=>s.cancelExam())}),(0,o.Wm)(h,{disable:0==s.newExam.exam_motive.length||0==s.newExam.nome.length,flat:"",color:0==s.newExam.exam_motive.length||0==s.newExam.nome.length?"secondary":"primary",label:"Enviar",onClick:t[17]||(t[17]=e=>s.sendExam())},null,8,["disable","color"])])),_:1})])),_:1},8,["class"])):(0,o.kq)("",!0),"DMD"==s.sendExamType?((0,o.wg)(),(0,o.j4)(z,{key:2,class:(0,l.C_)(e.$q.platform.is.desktop?"frmDlg":"")},{default:(0,o.w5)((()=>[(0,o.Wm)(m,null,{default:(0,o.w5)((()=>[(0,o._)("div",R,[A,(0,o._)("div",L,[(0,o.Wm)(i,{class:(0,l.C_)(s.readOnlyInfo?"text-primary":"text-dark"),name:s.readOnlyInfo?"lock":"lock_open",onClick:t[18]||(t[18]=e=>s.readOnlyInfo=!s.readOnlyInfo),style:{cursor:"pointer"},title:"Editar informações"},null,8,["class","name"])])])])),_:1}),(0,o.Wm)(m,null,{default:(0,o.w5)((()=>[F])),_:1}),(0,o.Wm)(x),(0,o.Wm)(v,{align:"center",class:"q-mr-lg",style:{top:"-5px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(g,{modelValue:s.newExam.urgente,"onUpdate:modelValue":t[19]||(t[19]=e=>s.newExam.urgente=e),label:"Exame Urgente",class:(0,l.C_)(["float-left q-mr-lg text-dark",s.newExam.urgente?"text-red":"text-dark"]),color:s.newExam.urgente?"red":"dark"},null,8,["modelValue","color","class"]),(0,o.Wm)(h,{flat:"",color:"primary",label:"Cancelar",onClick:t[20]||(t[20]=e=>s.cancelExam())}),(0,o.Wm)(h,{disable:0==s.newExam.exam_motive.length||0==s.newExam.nome.length,flat:"",color:0==s.newExam.exam_motive.length||0==s.newExam.nome.length?"secondary":"primary",label:"Enviar",onClick:t[21]||(t[21]=e=>s.sendExam())},null,8,["disable","color"])])),_:1})])),_:1},8,["class"])):(0,o.kq)("",!0)])),_:1},8,["modelValue","maximized"])])])}a(46727),a(40702),a(84641),a(83269),a(18964);var Q=a(84092),Y=a(50796),B=a(19302),G=a(98100),J=a.n(G),X=a(55834),K=a(58163);a(32332);const ee=["Taquicardia","Dor Torácica","Dispnéia","Palpitações","Desmaios","Formigamento MS","Formigamento MI"],te={name:"UplodFiles",data(){return{objExam:{},isPDF:!0}},methods:{addTag(e){const t={name:e,code:e.substring(0,2)+Math.floor(1e7*Math.random())};this.options.push(t),this.value.push(t)},addExam(e){var t,a,o,l,s,r,n,i,m,d,c,u,p,x,g,h,v,f;console.warn("birthdate",null!==(t=e.value.nascimento)&&void 0!==t?t:"1970-01-01","age",null!==(a=e.value.age)&&void 0!==a?a:0,"category",this.getCategory(),"cpf",null!==(o=e.value.cpf)&&void 0!==o?o:"","email",null!==(l=e.value.email)&&void 0!==l?l:"","exam",e.value.exam,"exam_motive",null!==(s=e.value.exam_motive)&&void 0!==s?s:"","nome",e.value.nome,"obs",null!==(r=e.value.obs)&&void 0!==r?r:"","phone",e.value.phone,"priority",e.value.urgente?1:3,"project",this.getProject(),"register",null!==(n=e.value.register)&&void 0!==n?n:"","senderid",e.value.senderid,"sex",null!==(i=e.value.sexo)&&void 0!==i?i:"","uuid",null!==(m=e.value.uuid)&&void 0!==m?m:""),this.$apollo.mutate({mutation:X.ZP`
            mutation newexam(
              $birthdate: String!
              $age: Int!
              $category: String!
              $cpf: String!
              $email: String!
              $exam: String!
              $exam_motive: jsonb!
              $nome: String!
              $obs: String!
              $phone: String!
              $priority: Int!
              $project: Int!
              $register: String!
              $senderid: Int!
              $sex: String!
              $status: Int!
              $uuid: uuid!
              $examhash: String!
            ) {
              newexam: insert_nxm_exams_one(
                object: {
                  birthdate: $birthdate
                  age: $age
                  category: $category
                  cpf: $cpf
                  created: "now()"
                  email: $email
                  exam: $exam
                  exam_motive: $exam_motive
                  lastupdate: "now()"
                  nome: $nome
                  obs: $obs
                  phone: $phone
                  priority: $priority
                  project: $project
                  register: $register
                  senderid: $senderid
                  sex: $sex
                  status: $status
                  uuid: $uuid
                  examhash: $examhash
                }
              ) {
                condition
                id
                lastupdate
              }
            }
          `,variables:{birthdate:e.value.nascimento,age:null!==(d=e.value.age)&&void 0!==d?d:0,category:this.getCategory(),cpf:null!==(c=e.value.cpf)&&void 0!==c?c:"",email:null!==(u=e.value.email)&&void 0!==u?u:"",exam:e.value.exam,exam_motive:null!==(p=e.value.exam_motive)&&void 0!==p?p:"",nome:e.value.nome,obs:null!==(x=e.value.obs)&&void 0!==x?x:"",phone:e.value.phone,priority:e.value.urgente?1:3,project:this.getProject(),register:null!==(g=e.value.register)&&void 0!==g?g:"",senderid:e.value.senderid,sex:null!==(h=e.value.sexo)&&void 0!==h?h:"",status:1,uuid:null!==(v=e.value.uuid)&&void 0!==v?v:"",examhash:null!==(f=e.value.examhash)&&void 0!==f?f:""}}).then((e=>{console.log("INSERT RESULT:",e)})).catch((e=>{console.error(e)}))},insertExam(e){if(this.isPDF){const t=e.textexam.toLowerCase().match(/"nome" || "paciente" || "id"/);if(t){const t=e.textexam.toLowerCase().match(/micromed/),a=(e.textexam.toLowerCase().match(/ecg/),e.textexam.toLowerCase().match(/bionet/)),o=e.textexam.toLowerCase().match(/cardioline/);if(t){const t=e.textexam;let a="";if(t.toLowerCase().match(/idade/))a="micromed3l";else{const e=t.toLowerCase().match(/nome:([\s\S]*?)reg[\s\S]*?/);null!=e&&(a=e[1].includes("nasc")?"micromed4l":"micromed6l")}this.getDataFromText(e.textexam,a)}else a?this.getDataFromText(e.textexam,"bionet"):o?this.getDataFromText(e.textexam,"cardioline"):this.getDataFromText(e.textexam,"teb")}else console.info("*********THERE'S NO TEXT********");this.showDlg(1)}else this.showDlg(null)},async checkDup(e){const t=e.hash;this.$apollo.query({query:X.ZP`
            query checkDup($hash: String!) {
              dupe: nxm_exams(where: { examhash: { _eq: $hash } }) {
                nome
                status
                created
                exam_motive
                obs
                senderid
              }
            }
          `,variables:{hash:t},fetchPolicy:"no-cache"}).then((t=>{const a=t.data;console.log("THE DUPPE data >>>>",a),console.log("THE DUPPE response >>>>",t),a.dupe.length>0?J().fire("Arquivo duplicado",`Este arquivo já foi enviado como pertencente a <br/> ${a.dupe[0].nome} <br/> enviado em ${this.formatDate(a.dupe[0].created)}`,"warning").then((e=>{this.cancelExam()})):this.insertExam(e)}))},formatDate(e){return g()(e).format("DD-MM-YYYY HH:mm:ss")},async scaleImageBeforeUpload(e,t){if(!e.type.match(/image.*/))return null;const a=new Image;a.src=URL.createObjectURL(e),await new Promise,Event;const o=document.createElement("canvas"),l=o.getContext("2d",{alpha:!0});if(o.width=t.width,o.height=t.height,a.height<=a.width){const e=o.height/a.height,t=e*a.width;l.drawImage(a,(o.width-t)/2,0,t,o.height)}else{const e=o.width/a.width,t=e*a.height;l.drawImage(a,0,(o.height-t)/2,o.width,t)}return new Promise((e=>o.toBlob(e)))}},setup(){(0,B.Z)();let e;const t=(0,K.A)(),a=(0,p.iH)(!0),l=(0,p.iH)("");let s=(0,p.iH)({exam:"",nome:"",sobrenome:"",email:"",phone:"",register:"",sexo:"",nascimento:"",age:0,cpf:"",exam_motive:[],obs:"",urgente:!1,category:""});const r=(0,o.f3)("emitter"),n=(0,p.iH)(!1),i=(0,p.iH)({}),m=(0,p.iH)(ee),d=function(e){i.value=e,n.value=!0},c=()=>{const e=sessionStorage.getItem("loggedUser"),t=JSON.parse(e);return null==t["id"]?null:t["id"]},u=()=>sessionStorage.getItem("sendExamType"),x=()=>JSON.parse(sessionStorage.getItem("loggedUser")).projects[0],v=()=>{s.value.exam="",s.value.nome="",s.value.sobrenome="",s.value.email="",s.value.phone="",s.value.register="",s.value.sexo="",s.value.nascimento="",s.value.age=0,s.value.cpf="",s.value.exam_motive=[],s.value.obs="",s.value.urgente=!1},f=e=>{const t=String.raw`${e.start}([\s\S]*?)${e.end}[\s\S]*?`;return t},w=(e,t)=>{var o,l;e=e.toUpperCase();const r=e.toLowerCase().match(/nome/)||e.toLowerCase().match(/name/)||e.toLowerCase().match(/paciente/)||"cardioline"==t;if(!r)return void(a.value=!1);let n,i;"cardioline"==t&&(n=e.includes("MASCULINO"),i=n?"MASCULINO":"FEMININO");let m={teb:{start:"PACIENTE:",end:"IDADE"},bionet:{start:"NAME :",end:"AGE"},cardioline:{start:"ID:",end:i},micromed:{start:"NOME:",end:"REG"},micromed3l:{start:"NOME:",end:"RG"},micromed4l:{start:"NOME:",end:"NASC"},micromed6l:{start:"NOME:",end:"REG"}},d={teb:{start:"SEXO:",end:"SEXO"},bionet:{start:"SEX :",end:"H"},micromed:{start:"NOME:",end:"RG"},cardioline:{start:i,end:i},micromed3l:{start:"SEXO:",end:"PESO"},micromed4l:{start:"NOME:",end:"NASC"},micromed6l:{start:"NOME:",end:"REG"}},c={teb:{start:"IDADE:",end:"ANOS"},bionet:{start:"AGE :",end:"YRS"},micromed:{start:"NOME:",end:"RG"},cardioline:{start:i,end:"\\("},micromed3l:{start:"NASC:",end:"IDADE"},micromed4l:{start:"NASC.:",end:"REG"},micromed6l:{start:"NASC.:",end:"RG"}},u={teb:{start:"PACIENTE:",end:"IDADE"},micromed:{start:"NOME:",end:"RG"},cardioline:{start:"ID:\n",end:"\n"},micromed3l:{start:"CPF:",end:"NASC"},micromed4l:{start:"CPF:",end:"FC"},micromed6l:{start:"CPF:",end:"FC"}},p=null!==(o=m[t])&&void 0!==o?o:"",x=new RegExp(f(p),"g");const h=x.exec(e);if(x=null,console.warn("THE NOME >>>>>>",h),"NAME : \nSURNAME : \nAGE"!=h[0]&&"NOME:\n \nRG"!=h[0]||(a.value=!1),s.value.nome=h[1].toUpperCase().replace("SURNAME : ","").replace(/\n/g," ").trim(),"cardioline"==t)s.value.sexo=n?"masculino":"feminino";else if("micromed4l"==t||"micromed6l"==t)s.value.sexo=null;else{var v;p=null!==(v=d[t])&&void 0!==v?v:"",x=new RegExp(f(p),"g");const a=x.exec(e);x=null,s.value.sexo=null==a?null:a[1].replace("M\n","masculino").replace("F\n","feminino").toLowerCase().trim()}if(p=null!==(l=c[t])&&void 0!==l?l:"","cardioline"==t){x=new RegExp(f(p),"g");const t=x.exec(e);s.value.nascimento=t[1].trim();const[a,o,l]=t[1].trim().split("/"),r=new Date(+l,o-1,+a);s.value.age=g()().diff(r,"years",!1)}else if("bionet"==t||"teb"==t){x=new RegExp(f(p),"g");const t=x.exec(e);var w;if(console.warn("THE NASCIMENTO >>>>",t),null!=t)s.value.nascimento=null!==(w=t[1].trim())&&void 0!==w?w:null,isNaN(t[1])?s.value.nascimento=t[1].trim():(s.value.age=t[1].trim(),s.value.nascimento=null)}else if("micromed6l"==t||"micromed4l"==t||"micromed3l"==t){x=new RegExp(f(p),"g");const t=x.exec(e);if(null!=t){s.value.nascimento=t[1].trim();const[e,a,o]=t[1].trim().split("/"),l=new Date(+o,a-1,+e);s.value.age=g()().diff(l,"years",!1)}else s.value.nascimento=null}if("micromed6l"==t||"micromed4l"==t||"micromed3l"==t){var E,y;p=null!==(E=u[t])&&void 0!==E?E:"",x=new RegExp(f(p),"g");const a=e.match(x);s.value.cpf=null!==(y=a[1])&&void 0!==y?y:null}},E=()=>{const e=sessionStorage.getItem("examID"),t=sessionStorage.getItem("examfile"),a=t.slice(2+(t.lastIndexOf(".")-1>>>0)),o={id:e,extension:a};h.Z.removeorfan(o).then((e=>{sessionStorage.removeItem("examID"),sessionStorage.removeItem("examfile"),sessionStorage.removeItem("exam-dump")}))},y=e=>{var t,a;t=0;let o=0;if("00000000000"==e)return!1;for(o=1;o<=9;o++)t+=parseInt(e.substring(o-1,o))*(11-o);if(a=10*t%11,10!=a&&11!=a||(a=0),a!=parseInt(e.substring(9,10)))return!1;for(t=0,o=1;o<=10;o++)t+=parseInt(e.substring(o-1,o))*(12-o);return a=10*t%11,10!=a&&11!=a||(a=0),a==parseInt(e.substring(10,11))},_=()=>{l.value=sessionStorage.getItem("sendExamType")},b=async()=>{const t=g()(new Date(s.value.nascimento)).isValid()?g()(s.value.nascimento).format("YYYY-MM-DD"):"";s.value.nascimento=t,s.value.uuid=(0,Y.Z)(),s.value.hd=null,s.value.cid=null,s.value.crm=null,s.value.medicname=null,s.value.project=x(),s.value.senderid=c(),s.value.status=1,s.value.priority=s.value.urgente?1:3,s.value.category=void 0==l.value||""==l.value?"ECG":l.value,r.emit("addExam",s),r.emit("reloadUI"),a.value=!0,setTimeout((()=>{e.removeAllFiles(),n.value=!1,v()}),500)};return(0,o.bv)((()=>{_(),e=new Q.f("#dropzone",{autoDiscover:!1,url:"https://api-rest.in/api/exam/upload",paramName:"sampleFile",message:"Arraste seu exame aqui!",maxFiles:1,acceptedFiles:"image/*,application/pdf",resizeWidth:1024,disabled:void 0==l.value||""==l.value,thumbnailHeight:96,thumbnailWidth:96,maxFilesize:100,addRemoveLinks:!1,headers:{Authorization:"Basic ZFc1cGJXVmtjbTl1Wkc5dWIzQnZiR2x6OllUTm1OREpoTVdRdE1XVXhZeTAwWldaaUxUZzJaRGd0TVRNNU16RTBNamc1Wmprdw=="},accept:async function(e,t){this.isPDF="application/pdf"==e.type,this.isPDF||console.log("THE FILE WIDTH",e),a.value=!0,v(),t()},success:function(e,t){console.warn("THE RESULT OF UPLOAD >>>>>",t),s.value.exam=t.exampath,s.value.examhash=t.hash,sessionStorage.setItem("examID",t.id),sessionStorage.setItem("examType",e.type),sessionStorage.setItem("examfile",t.exampath),r.emit("checkDup",t)},init:function(){this.on("resetFiles",(()=>{this.removeAllFiles()}))}}),e.autoDiscover=!1,e.on("addedfile",(t=>{t.type.match(/image/)||(e.emit("thumbnail",t,"pdf96.png"),t.previewElement.style.backgroundColor="transparent",t.previewElement.style.top="10px",t.previewElement.style.width="96px")}))})),{myDZ:e,coreStore:t,removeOrfan:E,newExam:s,dlgExam:n,theMsg:i,exam_motive:(0,p.iH)(null),sexo:(0,p.iH)(""),sexOptions:[{label:"Masculino",value:"masculino"},{label:"Feminino",value:"feminino"}],readOnlyInfo:a,filterOptions:m,emitter:r,sendExam:b,getProject:x,getCategory:u,getDataFromText:w,sendExamType:l,testarCPF:y,showDlg:d,createValue(e,t){e.length>0&&(ee.includes(e)||ee.push(e),t(e,"toggle"))},filterFn(e,t){t((()=>{if(""===e)m.value=ee;else{const t=e.toLowerCase();m.value=ee.filter((e=>e.toLowerCase().indexOf(t)>-1))}}))},cancelExam(){E(),e.removeAllFiles(),n.value=!1}}},created(){this.emitter.on("addExam",(e=>{this.addExam(e)})),this.emitter.on("checkDup",(e=>this.checkDup(e)))}};var ae=a(11639),oe=a(22857),le=a(32074),se=a(44458),re=a(63190),ne=a(8326),ie=a(66611),me=a(2286),de=a(18401),ce=a(50926),ue=a(11821),pe=a(23175),xe=a(24455),ge=a(57691),he=a(69984),ve=a.n(he);const fe=(0,ae.Z)(te,[["render",z],["__scopeId","data-v-0d326ecd"]]),we=fe;ve()(te,"components",{QIcon:oe.Z,QDialog:le.Z,QCard:se.Z,QCardSection:re.Z,QForm:ne.Z,QInput:ie.Z,QOptionGroup:me.Z,QSelect:de.Z,QSeparator:ce.Z,QCardActions:ue.Z,QToggle:pe.Z,QBtn:xe.Z,QChip:ge.Z});const Ee=e=>((0,o.dD)("data-v-42a689cc"),e=e(),(0,o.Cn)(),e),ye={class:"myCard q-py-md"},_e=(0,o.Uk)(" Exames aguardando Laudo "),be={class:"tlContainer"},ke={class:"tlLine row full-width"},qe={class:"criado text-dark q-py-xs",style:{"line-height":"98%"}},Ie=Ee((()=>(0,o._)("br",null,null,-1))),Ce={class:"tlSeparator"},Se=["title"],De={class:"col nome text-caption text-weight-light text-dark"};function $e(e,t,a,s,r,n){const i=(0,o.up)("q-badge"),m=(0,o.up)("q-icon"),d=(0,o.up)("q-scroll-area");return(0,o.wg)(),(0,o.iD)("div",ye,[(0,o._)("div",{class:"text-subtitle1 text-weight-light q-mb-md text-dark",style:{cursor:"pointer"},onClick:t[0]||(t[0]=e=>n.reloadList())},[_e,(0,o.Wm)(i,{color:"primary",align:"top"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(r.exams.length),1)])),_:1})]),(0,o.Wm)(d,{style:{height:"45vh"}},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.exams,(e=>((0,o.wg)(),(0,o.iD)("div",{class:"text-left q-mx-lg",color:"primary",key:e.created,dense:""},[(0,o._)("div",be,[(0,o._)("div",ke,[(0,o.Wm)(m,{name:"remove_circle_outline",color:"red",size:"20px",class:"q-mr-xs",style:{cursor:"pointer"},onClick:t=>n.deleteExam(e.id,e.nome,e.exam)},null,8,["onClick"]),(0,o.Wm)(m,{name:"visibility",color:"primary",size:"22px",class:"q-mr-sm aicon",clickable:"",tag:"a",target:"_blank",href:e.exam,style:{cursor:"pointer"}},null,8,["href"]),(0,o._)("div",qe,[(0,o._)("span",null,(0,l.zw)(n.hour(e.created).day),1),Ie,(0,o._)("span",null,(0,l.zw)(n.hour(e.created).hour),1)]),(0,o._)("div",Ce,[(0,o._)("span",{class:(0,l.C_)([1==e.priority?"dot-urgent":"dot-normal","dot"]),title:1==e.priority?"Enviado com urgencia":"Prioridade Normal"},null,10,Se)]),(0,o._)("div",De,(0,l.zw)(e.nome.toUpperCase()),1)])])])))),128))])),_:1})])}const Te={name:"ExamesEnviados",data(){return{sentExams:[],exams:[]}},apollo:{exams:{query:X.ZP`
        query exams($projects: [Int!], $status: Int!, $categories: [String!]) {
          exams: nxm_exams(
            where: {
              project: { _in: $projects }
              status: { _eq: $status }
              category: { _in: $categories }
            }
            order_by: { created: asc }
          ) {
            birthdate
            category
            created
            crm_origin
            exam
            exam_motive
            hd
            id
            medic_name
            nome
            obs
            priority
            sex
          }
        }
      `,pollInterval:6e4,variables(){return{status:1,projects:this.examparams["projects"],categories:this.examparams["categories"]}},update:e=>(sessionStorage.setItem("allExams",JSON.stringify(e.exams)),e.exams)}},created(){this.emitter.on("reloadUI",(()=>{const e=sessionStorage.getItem("sendExamType");this.$apollo.queries.exams.refetch({categories:e})})),this.emitter.on("changeExamType",(()=>{const e=sessionStorage.getItem("sendExamType");this.$apollo.queries.exams.refetch({categories:e})}))},methods:{reloadList:function(){const e=sessionStorage.getItem("sendExamType");this.$apollo.queries.exams.refetch({categories:e})},hour:function(e){g().locale("pt-br");const t=g().utc(e,"YYYY-MM-DD[T]HH:mm:SS").local().format("DD/MM"),a=g().utc(e,"YYYY-MM-DD[T]HH:mm:SS").local().format("HH:mm");return{day:t,hour:a}},getProject(){const e=sessionStorage.getItem("loggedUser"),t=JSON.parse(e);return null==t["Project"]?null:t["Project"][0]},getType(){const e=localStorage.getItem("sendExamType"),t=void 0==e?"ECG":e;return t},deleteExam(e,t,a){J().fire({title:`Apagar o exame de\n${t}?`,text:"Você está prestes a apagar este exame e não poderá reverter esta ação!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Sim, apagar!"}).then((o=>{if(o.isConfirmed){const o=a.replace("https://api-rest.in/exams/","").replace(".pdf","");h.Z.deletepg({exam:o}).then((e=>{this.$apollo.queries.exams.refetch()})).catch((e=>{console.error("DELETE FILE ERROR",e)})),this.$apollo.mutate({mutation:X.ZP`
                mutation delete($id: Int!) {
                  exam: delete_nxm_exams_by_pk(id: $id) {
                    id
                  }
                }
              `,variables:{id:e}}).then((e=>{J().fire("Apagado!",`Você apagou o exame de \n${t}`,"success"),this.$apollo.queries.exams.refetch()})).catch((e=>{console.error(e),J().fire("Ooops!",`Houve um erro apagando o exame de \n${t}. Tente novamente.`,"error")}))}}))}},computed:{examparams(){const e=JSON.parse(sessionStorage.getItem("loggedUser")),t=e.projects,a=e.scope,o={projects:t,categories:a};return o}},setup(){const e=(0,o.f3)("emitter");return{emitter:e}}};var We=a(20990),Pe=a(66663);const Oe=(0,ae.Z)(Te,[["render",$e],["__scopeId","data-v-42a689cc"]]),Ue=Oe;ve()(Te,"components",{QBadge:We.Z,QScrollArea:Pe.Z,QIcon:oe.Z});const Ze=e=>((0,o.dD)("data-v-03c0b934"),e=e(),(0,o.Cn)(),e),je={class:"myCard q-py-md"},Me={class:"text-h6 text-weight-light q-mb-md text-dark"},Ve=(0,o.Uk)(" Exames para Repetir "),He={class:"text-weight-light",style:{"font-size":"16px"}},Ne=Ze((()=>(0,o._)("br",null,null,-1))),Re=(0,o.Uk)(" Enviado em "),Ae={class:"text-red-8"},Le=Ze((()=>(0,o._)("span",{class:"cursor-pointer text-weight-medium"},"Ver o exame original",-1))),Fe={class:"text-grey-8 q-gutter-xs text-primary"};function ze(e,t,a,s,r,n){const i=(0,o.up)("q-badge"),m=(0,o.up)("q-icon"),d=(0,o.up)("q-item-label"),c=(0,o.up)("q-item-section"),u=(0,o.up)("q-btn"),p=(0,o.up)("q-item"),x=(0,o.up)("q-separator"),g=(0,o.up)("q-list"),h=(0,o.up)("q-scroll-area");return(0,o.wg)(),(0,o.iD)("div",je,[(0,o._)("div",Me,[Ve,(0,o.Wm)(i,{color:"primary",align:"top"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(r.repeat.length),1)])),_:1})]),(0,o.Wm)(h,{style:{height:"65vh"}},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.repeat,(e=>((0,o.wg)(),(0,o.iD)("div",{class:"text-left q-mx-lg",color:"primary",key:e.created,dense:""},[(0,o.Wm)(g,{class:"rounded-borders text-dark",style:{"max-width":"600px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(p,null,{default:(0,o.w5)((()=>[(0,o.Wm)(c,{top:"",class:"col-2"},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{class:"q-mt-sm"},{default:(0,o.w5)((()=>[(0,o.Wm)(m,{name:"heart_broken",color:"warning",size:"34px"})])),_:1})])),_:1}),(0,o.Wm)(c,{top:""},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{lines:"1"},{default:(0,o.w5)((()=>[(0,o._)("span",He,(0,l.zw)(e.nome),1)])),_:2},1024),(0,o.Wm)(d,{lines:"3",caption:"",class:"text-dark text-weight-light"},{default:(0,o.w5)((()=>[(0,o.Uk)(" * "+(0,l.zw)(e.rejected),1),Ne,Re,(0,o._)("span",Ae,(0,l.zw)(n.hour(e.created).day)+" às "+(0,l.zw)(n.hour(e.created).hour),1)])),_:2},1024),(0,o.Wm)(d,{lines:"1",class:"q-mt-xs text-body2 text-weight-bold text-primary text-uppercase",onClick:t=>n.openExam(e.exam)},{default:(0,o.w5)((()=>[Le])),_:2},1032,["onClick"])])),_:2},1024),(0,o.Wm)(c,{middle:"",side:""},{default:(0,o.w5)((()=>[(0,o._)("div",Fe,[(0,o.Wm)(u,{class:"gt-xs text-dark",size:"12px",flat:"",dense:"",round:"",icon:"remove_circle_outline",onClick:t=>n.deleteExam(e.id,e.nome,e.exam)},null,8,["onClick"]),(0,o.Wm)(u,{class:"gt-xs text-dark",size:"12px",flat:"",dense:"",round:"",icon:"done",onClick:t=>n.arquive(e.id)},null,8,["onClick"]),(0,o.Wm)(u,{size:"12px",class:"text-dark",flat:"",dense:"",round:"",icon:"more_vert"})])])),_:2},1024)])),_:2},1024),(0,o.Wm)(x,{spaced:"10px"})])),_:2},1024)])))),128))])),_:1})])}var Qe=a(33752);const Ye={name:"ExamesEnviados",data(){return{sentExams:[],repeat:[]}},apollo:{repeat:{query:X.ZP`
        query exams($projects: [Int!], $status: Int!, $categories: [String!]) {
          exams: nxm_exams(
            where: {
              project: { _in: $projects }
              status: { _eq: $status }
              category: { _in: $categories }
            }
            order_by: { created: asc }
          ) {
            birthdate
            category
            created
            crm_origin
            exam
            exam_motive
            hd
            id
            medic_name
            nome
            obs
            priority
            sex
            rejected
          }
        }
      `,pollInterval:6e4,variables(){return{status:3,projects:this.examparams["projects"],categories:this.examparams["categories"]}},update:e=>(sessionStorage.setItem("allExams",JSON.stringify(e.exams)),console.warn("THE SENT EXAMS >>>>",e),e.exams)}},created(){this.emitter.on("reloadUI",(()=>this.$apollo.queries.repeat.refetch())),this.emitter.on("changeExamType",(()=>{const e=sessionStorage.getItem("sendExamType");this.$apollo.queries.repeat.refetch({categories:e})}))},methods:{arquive:function(e){this.emitter.emit("arquive",e)},hour:function(e){g().locale("pt-br");const t=g().utc(e,"YYYY-MM-DD[T]HH:mm:SS").local().format("DD/MM"),a=g().utc(e,"YYYY-MM-DD[T]HH:mm:SS").local().format("HH:mm");return{day:t,hour:a}},getProject(){const e=sessionStorage.getItem("loggedUser"),t=JSON.parse(e);return null==t["Project"]?null:t["Project"][0]},getType(){const e=localStorage.getItem("sendExamType"),t=void 0==e?"ECG":e;return t},deleteExam(e,t,a){J().fire({title:`Apagar o exame de \n ${t}?`,text:"Você está prestes a apagar este exame e não poderá reverter esta ação!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Sim, apagar!",cancelButtonText:"Cancelar!"}).then((o=>{if(o.isConfirmed){const o=a.replace("https://api-rest.in/exams/","").replace(".pdf","");h.Z.deletepg({exam:o}).then((e=>{console.log("DELETE FILE >>>",e),this.$apollo.queries.repeat.refetch()})).catch((e=>{console.error("DELETE FILE ERROR",e)})),this.$apollo.mutate({mutation:X.ZP`
                mutation delete($id: Int!) {
                  exam: delete_nxm_exams_by_pk(id: $id) {
                    id
                  }
                }
              `,variables:{id:e}}).then((e=>{J().fire("Apagado!",`Você apagou o exame de \n${t}`,"success"),console.warn("THE DELETED EXAM >>>>",e),this.$apollo.queries.repeat.refetch()})).catch((e=>{console.error(e),J().fire("Ooops!",`Houve um erro apagando o exame de \n${t}. Tente novamente.`,"error")}))}}))},openExam(e){(0,Qe.Z)(e)}},mounted(){},setup(){const e=(0,o.f3)("emitter");return{emitter:e}},computed:{examparams(){const e=JSON.parse(sessionStorage.getItem("loggedUser")),t=e.projects,a=e.scope,o={projects:t,categories:a};return console.log("THE EXAM-PARAMS >>>>",o),o}}};var Be=a(13246),Ge=a(490),Je=a(76749),Xe=a(33115);const Ke=(0,ae.Z)(Ye,[["render",ze],["__scopeId","data-v-03c0b934"]]),et=Ke;ve()(Ye,"components",{QBadge:We.Z,QScrollArea:Pe.Z,QList:Be.Z,QItem:Ge.Z,QItemSection:Je.Z,QItemLabel:Xe.Z,QIcon:oe.Z,QBtn:xe.Z,QSeparator:ce.Z});var tt=a(61957);const at=e=>((0,o.dD)("data-v-091f90ec"),e=e(),(0,o.Cn)(),e),ot={class:"myCard q-py-md"},lt={class:"text-h6 text-weight-light text-dark"},st=(0,o.Uk)(" Exames Laudados "),rt={key:0},nt={key:0,class:"row full-width",style:{"border-bottom":"1px dashed #b4ede5"}},it={class:"col-2 text-right q-pr-md"},mt={class:"col inline justify-end"},dt={class:"row justify-end q-mr-lg"},ct={class:"text-weight-medium"},ut=at((()=>(0,o._)("br",null,null,-1))),pt={class:"text-grey-8 q-gutter-xs text-primary"};function xt(e,t,a,s,r,n){const i=(0,o.up)("q-badge"),m=(0,o.up)("q-btn"),d=(0,o.up)("q-input"),c=(0,o.up)("q-expansion-item"),u=(0,o.up)("q-toggle"),p=(0,o.up)("q-icon"),x=(0,o.up)("q-item-label"),g=(0,o.up)("q-item-section"),h=(0,o.up)("q-item"),v=(0,o.up)("q-separator"),f=(0,o.up)("q-list"),w=(0,o.up)("q-scroll-area");return(0,o.wg)(),(0,o.iD)("div",ot,[(0,o._)("div",lt,[st,r.showPrinted?((0,o.wg)(),(0,o.iD)("span",rt,"e Impressos")):(0,o.kq)("",!0),(0,o.Wm)(i,{color:"primary",align:"top"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(n.outputExams.length),1)])),_:1})]),e.$q.platform.is.desktop?((0,o.wg)(),(0,o.iD)("div",nt,[(0,o._)("div",it,[r.showPrinted?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(m,{key:0,color:r.allHeartsSelected?"dark":"secondary",flat:"",icon:"favorite",title:"Selecionar todos",onClick:t[0]||(t[0]=e=>n.selectAllHearts())},null,8,["color"]))]),(0,o._)("div",mt,[(0,o._)("div",dt,[r.toPrint.length>0?((0,o.wg)(),(0,o.j4)(m,{key:0,color:"dark",flat:"",icon:"local_printshop",title:"Imprimir exames selecionados",onClick:t[1]||(t[1]=e=>n.bulkPrint())})):(0,o.kq)("",!0),(0,o.Wm)(c,{class:"text-primary","header-class":"text-dark",dense:"","dense-toggle":"","expand-separator":"",icon:"search",onClick:t[3]||(t[3]=e=>n.focusInput())},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{modelValue:r.searchQuery,"onUpdate:modelValue":t[2]||(t[2]=e=>r.searchQuery=e),ref:"searchInput",autofocus:"","input-style":{width:"300px"},outlined:"",dense:"",type:"search",placeholder:"Digite para localizar",color:"primary","label-color":"text-dark"},null,8,["modelValue"])])),_:1}),(0,o.Wm)(u,{title:"Examos impressos",size:"xs",color:"primary",icon:"print",modelValue:r.showPrinted,"onUpdate:modelValue":t[4]||(t[4]=e=>r.showPrinted=e)},null,8,["modelValue"])])])])):(0,o.kq)("",!0),(0,o.Wm)(w,{style:{height:"65vh"}},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(n.filteredList,((t,a)=>((0,o.wg)(),(0,o.iD)("div",{class:"text-left q-mx-lg",color:"primary",key:a,dense:""},[(0,o.Wm)(f,{class:"rounded-borders text-dark",style:{"max-width":"600px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(h,null,{default:(0,o.w5)((()=>[(0,o.wy)((0,o.Wm)(g,{top:"",class:"col-1"},{default:(0,o.w5)((()=>[(0,o.Wm)(x,null,{default:(0,o.w5)((()=>[(0,o.Wm)(p,{name:"volunteer_activism",color:1==t.priority?"red":"teal-1",size:"24px",title:1==t.priority?"EXAME URGENTE":"",style:{cursor:"pointer"},onClick:e=>n.toggleHeart(a,t.exam,t.id)},null,8,["color","title","onClick"])])),_:2},1024),(0,o.Wm)(x,{class:"q-mt-sm"},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{name:r.toPrint.includes(t.exam.split(/[\\\/]/).pop())?"local_printshop":"favorite_border",color:n.getHeartColor(t.condition),size:"24px",style:{cursor:"pointer"},onClick:e=>n.toggleHeart(a,t.exam,t._id)},null,8,["name","color","onClick"])])),_:2},1024)])),_:2},1536),[[tt.F8,e.$q.platform.is.desktop]]),(0,o.Wm)(g,{top:"",onClick:e=>n.gotoExam(t.exam),style:{cursor:"pointer"}},{default:(0,o.w5)((()=>[(0,o.Wm)(x,{lines:"1"},{default:(0,o.w5)((()=>[(0,o._)("span",ct,(0,l.zw)(t.nome),1)])),_:2},1024),(0,o.Wm)(x,{lines:"2",caption:"",class:"text-dark"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(t.category),1),ut,(0,o.Uk)(" Laudado em "+(0,l.zw)(n.hour(t.appraised).day)+" às "+(0,l.zw)(n.hour(t.appraised).hour),1)])),_:2},1024),(0,o.Wm)(x,{lines:"1",class:"q-mt-xs text-body2 text-weight-bold text-primary text-uppercase"})])),_:2},1032,["onClick"]),(0,o.Wm)(g,{middle:"",side:""},{default:(0,o.w5)((()=>[(0,o._)("div",pt,[(0,o.Wm)(m,{class:"gt-xs text-dark",size:"12px",flat:"",dense:"",round:"",icon:"visibility",onClick:e=>n.gotoExam(t.exam)},null,8,["onClick"]),e.$q.platform.is.desktop?((0,o.wg)(),(0,o.j4)(m,{key:0,class:"gt-xs text-dark",size:"12px",flat:"",dense:"",round:"",icon:"email"})):(0,o.kq)("",!0),e.$q.platform.is.desktop?((0,o.wg)(),(0,o.j4)(m,{key:1,size:"12px",flat:"",dense:"",round:"",icon:"local_printshop",class:"text-dark",onClick:e=>n.printExam(t.exam,t.nome)},null,8,["onClick"])):(0,o.kq)("",!0)])])),_:2},1024)])),_:2},1024),(0,o.Wm)(v,{spaced:"10px"})])),_:2},1024)])))),128))])),_:1})])}var gt=a(64906),ht=a.n(gt),vt=a(94886);const ft={name:"ExamesEnviados",data(){return{allHeartsSelected:!1,searchQuery:"",iconHeart:-1,toPrint:[],idPrinted:[],sentExams:[],printedExams:[],notPrintedExams:[],showPrinted:!1}},created(){this.emitter.on("changeExamType",(()=>{const e=sessionStorage.getItem("sendExamType");this.refetch({categories:e})}))},methods:{mailto(){},selectAllHearts(){this.allHeartsSelected=!this.allHeartsSelected,this.filteredList.forEach((e=>{this.toggleHeart(e.index,e.exam,e.id)}))},getHeartColor(e){let t={normal:"primary",alterado:"orange",critico:"red",default:"primary"};return t[e]||t["default"]},toggleHeart(e,t,a){const o=t.split(/[\\\/]/).pop();if(this.toPrint.includes(o)){const e=this.toPrint.indexOf(o),t=this.idPrinted.indexOf(a);this.toPrint.splice(e,1),this.idPrinted.splice(t,1)}else this.toPrint.push(o),this.idPrinted.push(a)},gotoExam(e){(0,Qe.Z)(e,"_blank",{noopener:!0,menubar:!0,toolbar:!1,noreferrer:!0})},printExam(e,t){ht()({printable:e,type:"pdf",showModal:!0,modalMessage:"Processando arquivo...",documentTitle:t})},bulkPrint(){if(0==this.toPrint.length)return;const e=sessionStorage.getItem("loggedUser"),t=JSON.parse(e),a={id:t._id,paths:this.toPrint,ids:this.idPrinted};this.$apollo.mutate({mutation:X.ZP`
            mutation printed($ids: [Int!]) {
              update_nxm_exams(
                where: { id: { _in: $ids } }
                _set: { printed: true }
              ) {
                affected_rows
              }
            }
          `,variables:{ids:this.idPrinted}}).then((e=>{h.Z.bulkPrint(a).then((e=>{const t=e.data["url"];ht()({printable:t,type:"pdf",showModal:!0,modalMessage:"Processando arquivo...",documentTitle:"Arquivo de lote"})})).catch((e=>{console.error("ERRO GERANDO BULK",e)}))})).catch((e=>{console.error("BULK-PRINT ERROR >>>>",e)}))},focusInput(){this.$nextTick((()=>this.$refs["searchInput"].focus()))},hour:function(e){g()().locale("pt-br");const t=g().utc(e,"YYYY-MM-DD[T]HH:mm:SS").local().format("DD/MM"),a=g().utc(e,"YYYY-MM-DD[T]HH:mm:SS").local().format("HH:mm");return{day:t,hour:a}},deleteExam(e,t,a){J().fire({title:`Apagar o exame de ${t}?`,text:"Você está prestes a apagar este exame e não poderá reverter esta ação!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Sim, apagar!"}).then((o=>{if(o.isConfirmed){const o={id:e,exam:a};h.Z.deletexam(o).then((e=>{const a=e.data;201==a.code?(this.retrieveExams(),J().fire("Apagado!",`Você apagou o exame de \n${t}`,"success")):J().fire("Ooops!",`Houve um erro apagando o exame de \n${t}. Tente novamente.`,"error")}))}}))}},setup(){const e=(0,K.A)(),t=(0,p.qj)({pollInterval:6e4}),a=(0,p.qj)({status:2,categories:[],projects:[]}),l=(0,o.f3)("emitter"),{result:s,refetch:r,error:n}=(0,vt.aM)(X.ZP`
        query exams($projects: [Int!], $status: Int!, $categories: [String!]) {
          appraised: nxm_exams(
            where: {
              project: { _in: $projects }
              status: { _eq: $status }
              category: { _in: $categories }
            }
            order_by: { created: asc }
          ) {
            category
            condition
            created
            exam
            exam_motive
            id
            medic_name
            nome
            priority
            printed
            status
            appraised
          }
        }
      `,a,t);return(0,o.m0)((()=>{if(s.value){const t=s.value;e.$state.appraisedExams=t.appraised}})),(0,o.bv)((()=>{var e,t;a.status=2,a.projects=null!==(e=null===(t=JSON.parse(sessionStorage.getItem("loggedUser")))||void 0===t?void 0:t.projects)&&void 0!==e?e:[];const o=sessionStorage.getItem("sendExamType");a.categories=[o]})),{emitter:l,coreStore:e,refetch:r,error:n,result:s,variables:a}},computed:{filteredList:function(){var e=this;return this.outputExams.filter((function(t){var a=new RegExp(e.searchQuery,"i");return a.test(t.nome)||a.test(t.exam)||a.test(t.created)||a.test(t.motivoexame)||a.test(t.nascimento)||a.test(t.observacoes)||a.test(t.category)||a.test(t.appraised)||a.test(t.crm)||a.test(t.hd)||a.test(t.medicname)||a.test(t.sexo)}))},outputExams(){const e=this.coreStore.$state.appraisedExams,t=e.filter((e=>e.printed==this.showPrinted));return t}}};var wt=a(50651);const Et=(0,ae.Z)(ft,[["render",xt],["__scopeId","data-v-091f90ec"]]),yt=Et;ve()(ft,"components",{QBadge:We.Z,QBtn:xe.Z,QExpansionItem:wt.Z,QInput:ie.Z,QToggle:pe.Z,QScrollArea:Pe.Z,QList:Be.Z,QItem:Ge.Z,QItemSection:Je.Z,QItemLabel:Xe.Z,QIcon:oe.Z,QSeparator:ce.Z});const _t={components:{UploadFiles:we,ExamesEnviados:Ue,ExamesRepetir:et,ExamesLaudados:yt},computed:{today:function(){return g().locale("pt-br"),g()().format("LL")}},methods:{async arquive(e){J().fire({title:"Remover exame da lista",text:"Esta ação não é reversível",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Sim! Remover.",cancelButtonText:"Cancelar"}).then((t=>{if(t.isConfirmed){const t={id:e,status:4};h.Z.lockexam(t).then((e=>{this.emitter.emit("reloadUI")}))}}))}},created(){this.emitter.on("arquive",(e=>this.arquive(e))),this.emitter.on("changeExamType",(()=>{this.upcount++}))},setup(){(0,o.f3)("emitter");const e=(0,p.iH)(0),t=(0,p.iH)(!0),a=[{label:"ECG",value:"ECG"},{label:"EEG",value:"EEG"},{label:"DMD",value:"DMD"}],l=function(){localStorage.setItem("sendExamType",this.sendExam)},s=function(){const e=localStorage.getItem("sendExamType");this.sendExam=e};return{upcount:e,showDiv:t,optExams:a,toggleDiv(){t.value=!t.value},sendExamType:l,getExamType:s}}};var bt=a(69885);const kt=(0,ae.Z)(_t,[["render",u],["__scopeId","data-v-3599ad89"]]),qt=kt;ve()(_t,"components",{QPage:bt.Z,QIcon:oe.Z})}}]);