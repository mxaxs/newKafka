(function(){(window.wpCoreControlsBundle=window.wpCoreControlsBundle||[]).push([[7],{140:function(e,t,r){function n(e,t,r,n){return Object(w.b)(void 0,void 0,void 0,(function(){var a,o,l,c,u,s,f,m,g;return Object(w.d)(this,(function(d){switch(d.label){case 0:return a=N.getDocument(),o=[1],[4,Object(E.c)(t,{extension:"pdf"})];case 1:return l=d.fa(),c=N.Da(),f=(s=F.a).a7,[4,l.Kx()];case 2:return u=f.apply(s,[d.fa().xfdfString,e]),m=!0,[4,a.Kf(l,o,e,m)];case 3:return d.fa(),[4,a.zg([e+1],m)];case 4:return d.fa(),g=c.Zg().filter((function(t){return t.CN()&&t.PageNumber===e})),c.vs(g,{force:!0,source:"contentEditTool"}),[4,c.fN(u)];case 5:return d.fa(),N.getDocument().OF(),N.NF(e),N.ae(),i(e),p(e,r.galleys,n),p(e,r.objects,n),[2]}}))}))}function a(e){return e=(new DOMParser).parseFromString(e,"text/html").documentElement.querySelector("body"),e.querySelectorAll("p").forEach((function(e){e.querySelectorAll("span").forEach((function(e){var t=e.getAttribute("style");t=o(t,e.innerHTML),e.innerHTML=t}));var t=e.getAttribute("style"),r=e.innerHTML.replaceAll("<br>","");e.innerHTML=o(t,r)})),e.innerHTML.trim()}function o(e,t){return e.includes("bold")&&(t="<strong>"+t+"</strong>"),e.includes("italic")&&(t="<em>"+t+"</em>"),e.includes("text-decoration: underline")&&(t="<u>"+t+"</u>"),t}function i(e){var t=N.Da(),r=t.Zg().filter((function(t){return t.rt()&&t.PageNumber===e}));t.vs(r,{force:!0,source:"contentEditTool"})}function l(e,t){t.forEach((function(t){V[e]||(V[e]=[]),V[e].find((function(e){return e.id===t.id}))||V[e].push(t)}))}function c(e,t){t.forEach((function(t){H[e]||(H[e]=[]),H[e].find((function(e){return e.id===t.id}))||H[e].push(t)}))}function u(e){var t=new DOMParser,r=t.parseFromString(e,"text/xml");return r.querySelector("parsererror")&&(r=t.parseFromString("<Root>"+e+"</Root>","text/xml")),r.querySelectorAll("a").forEach((function(e){var t=e.childNodes[0];Array.from(e.querySelectorAll("*")).find((function(e){return"u"===e.tagName.toLowerCase()}))||(e=document.createElement("u"),t.after(e),e.appendChild(t))})),(new XMLSerializer).serializeToString(r)}function s(e,t,r,n){this.top=e,this.left=t,this.bottom=r,this.right=n,this.topVal=function(){return Math.round(this.top)},this.bottomVal=function(){return Math.round(this.bottom)},this.leftVal=function(){return Math.round(this.left)},this.rightVal=function(){return Math.round(this.right)},this.height=function(){return Math.round(Math.abs(this.top-this.bottom))},this.width=function(){return Math.round(this.right-this.left)},this.nK=function(e){return this.topVal()!=e.topVal()||this.leftVal()!=e.leftVal()||this.bottomVal()!=e.bottomVal()||this.rightVal()!=e.rightVal()}}function f(e,t,r,n,a){this.id=e,this.pagenum=t,this.galleysContents=r,this.contents=n,this.galleyBox=a}function m(e,t,r,n){this.id=t,this.type=e,this.bbox=r,this.pagenum=n}function g(e,t,r,n,a){this.id=e,this.pagecount=t,this.pageBBox=r,this.galleys=n,this.objects=a}function d(e,t,r,n,a){var o=[];(new DOMParser).parseFromString(n,"text/html").documentElement.querySelectorAll("p").forEach((function(e,t){o[t]=e.innerHTML})),r=(new DOMParser).parseFromString(r,"text/html");var i=null;for(r.documentElement.querySelectorAll("p").forEach((function(e,t){t<o.length?(e.innerHTML=o[t],i=e.getAttribute("style"),i=i.replace("font:italic","font:normal"),i=i.replace(" bold "," normal "),i=i.replace("underline:1;","underline:0;"),e.setAttribute("style",i)):e.remove()})),n=r.documentElement.querySelectorAll("p").length;n<o.length;n++){var l=document.createElement("p");l.setAttribute("id","0"),l.innerHTML=o[n],null!=i&&l.setAttribute("style",i),r.documentElement.querySelector("body").appendChild(l)}r=r.documentElement.querySelector("body").innerHTML;var c="";return H[e].forEach((function(e){e.id==a&&(c=e)})),""==c?"":(t="<DOC id='"+t.id+"' pagecount='"+t.pagecount+"'>",t=t+"<STORY galley_ids='"+a+"' pagenum='"+e+"'><galleys>"+c.galleysContents+"</galleys>",c.contents=r,t=t+r+"\n</STORY>",t+"</DOC>")}function p(e,t,r){var n=[],a=N.getDocument(),o=null;t.forEach((function(t){if(t instanceof m){var i=a.rl(e,t.bbox.leftVal(),t.bbox.topVal()),l=i.x,c=i.y,u=a.rl(e,t.bbox.rightVal(),t.bbox.bottomVal());i=u.x,u=u.y}else{if(!(t instanceof f))return;i=a.rl(e,t.galleyBox.leftVal(),t.galleyBox.topVal()),l=i.x,c=i.y,u=a.rl(e,t.galleyBox.rightVal(),t.galleyBox.bottomVal()),i=u.x,u=u.y}var s=new window.Core.Annotations.RectangleAnnotation,g=L.a.OBJECT;t instanceof f&&(g=L.a.TEXT),s.v9(t,g),s.PageNumber=t.pagenum,s.X=l,s.Y=c,s.Width=i-l,s.Height=u-c,s.StrokeColor=new M.a("#3183C8"),s.FillColor=new M.a(255,255,255,.01),s.Style="dash",s.Dashes="4,3",s.eL(),s.selectionModel=B.a,n.push(s),"undefined"!==typeof r&&r===t.id&&(o=s)})),t=N.Da(),t.zm(n),o&&t.Yn(o),t.rj(n)}function b(e,t,r){return Object(w.b)(this,void 0,void 0,(function(){var a,o,u,s;return Object(w.d)(this,(function(f){switch(f.label){case 0:switch(a=e.data,u=a.cmd,u){case"isReady":return[3,1];case"initialiseInfixServer":return[3,3];case"exportFile":return[3,4];case"importText":return[3,5];case"transformObject":return[3,5];case"deleteObject":return[3,6]}return[3,7];case 1:return[4,Object(O.b)()];case 2:return s=f.fa(),S.postMessage({cmd:"initialiseInfixServer",l:s}),[3,7];case 3:return h(a.resultsXML)?t():r("License key does not have content edit permission"),[3,7];case 4:return a.exportPerformed?y(a.pageNumber,a.exportXML,a.objectXML,a.resultsXML):(o=C[a.pageNumber],c(a.pageNumber,o.galleys),l(a.pageNumber,o.objects),i(a.pageNumber),p(a.pageNumber,o.galleys),p(a.pageNumber,o.objects)),[3,7];case 5:return o=C[a.pageNumber],x(a.pageNumber,a.resultsXML),n(a.pageNumber,a.pdfBuffer,o,a.id),[3,7];case 6:return o=C[a.pageNumber],x(a.pageNumber,a.resultsXML),o.galleys=o.galleys.filter((function(e){return e.id!==a.id})),o.objects=o.objects.filter((function(e){return e.id!==a.id})),n(a.pageNumber,a.pdfBuffer,o),[3,7];case 7:return[2]}}))}))}function h(e){e=new Uint8Array(e);var t=new TextDecoder("utf-8").decode(e);return e=!1,t=(new DOMParser).parseFromString(t,"text/xml").getElementsByTagName("LicenseCheck"),null!==t&&0<t.length&&(t=t[0].getElementsByTagName("Status")[0].innerHTML,"error"!=t&&"ok"==t&&(e=!0)),e}function y(e,t,r,n){var a=new Uint8Array(t),o=new TextDecoder("utf-8");t=o.decode(a),a=new Uint8Array(r),r=o.decode(a),a=new Uint8Array(n),n=o.decode(a),C[e]=v(e,t,r,n),n=C[e],c(e,n.galleys),l(e,n.objects),i(e),p(e,n.galleys),p(e,n.objects)}function T(e,t){return e=parseFloat(e),isNaN(t)||t<e?e:t}function v(e,t,r,n){var a,o=new DOMParser;n=o.parseFromString(n,"text/xml"),Array.prototype.slice.call(n.getElementsByTagName("BBox")).forEach((function(e){if("CropBox"==e.getAttribute("Name")){var t=parseFloat(e.getElementsByTagName("Top").item(0).innerHTML),r=parseFloat(e.getElementsByTagName("Bottom").item(0).innerHTML),n=parseFloat(e.getElementsByTagName("Left").item(0).innerHTML);e=parseFloat(e.getElementsByTagName("Right").item(0).innerHTML),a=new s(t,n,r,e)}})),o=new DOMParser,n=o.parseFromString(t,"text/xml");var i=[];Array.prototype.slice.call(n.getElementsByTagName("STORY")).forEach((function(t){var r=t.getAttribute("galley_ids"),n=Array.prototype.slice.call(t.getElementsByTagName("g"))[0],a=n.getAttribute("bbox").split(" ");a=new s(parseFloat(a[0]),parseFloat(a[1]),parseFloat(a[2]),parseFloat(a[3])),n=n.innerHTML;var o=Array.prototype.slice.call(t.getElementsByTagName("galleys"))[0];o.parentNode.removeChild(o),t=t.innerHTML,t=(new DOMParser).parseFromString(t,"text/html").documentElement.querySelector("body").innerHTML.trim(),r=new f(r,e,n,t,a),i.push(r)})),o=new DOMParser;var l=[];return t=o.parseFromString(r,"text/xml").getElementsByTagName("Object"),Array.prototype.slice.call(t).forEach((function(t){var r=t.getAttribute("Type"),n=t.getAttribute("OID");t=Array.prototype.slice.call(t.getElementsByTagName("Point"));var a=Number.NaN,o=Number.NaN,i=Number.NaN,c=Number.NaN;t.forEach((function(e){var t=e.getAttribute("Name");"TL"==t?(a=T(e.getAttribute("Y"),a),i=T(e.getAttribute("X"),i)):"TR"==t?(a=T(e.getAttribute("Y"),a),c=T(e.getAttribute("X"),c)):"BR"==t?(o=T(e.getAttribute("Y"),o),c=T(e.getAttribute("X"),c)):"BL"==t&&(o=T(e.getAttribute("Y"),o),i=T(e.getAttribute("X"),i))})),t=new s(a,i,o,c),r=new m(r,n,t,e),l.push(r)})),t=Array.prototype.slice.call(n.getElementsByTagName("DOC"))[0].getAttribute("id"),new g(t,1,a,i,l)}function x(e,t){var r;t=new TextDecoder("utf-8").decode(t),t=(new DOMParser).parseFromString(t,"text/xml");var n=t.getElementsByTagName("Galley").item(0);if(null!=n){var a=n.getAttribute("id");n=t.getElementsByTagName("BBox"),n=Array.prototype.slice.call(n),n.forEach((function(e){var t=e.getElementsByTagName("Top"),n=parseFloat(t.item(0).innerHTML);t=e.getElementsByTagName("Left");var a=parseFloat(t.item(0).innerHTML);t=e.getElementsByTagName("Bottom");var o=parseFloat(t.item(0).innerHTML);t=e.getElementsByTagName("Right"),e=parseFloat(t.item(0).innerHTML),r=new s(n,a,o,e)})),H[e].forEach((function(e){e.id==a&&1==r.nK(e.galleyBox)&&(e.galleyBox=r)}))}if(n=t.getElementsByTagName("Object").item(0),null!=n){var o=n.getAttribute("OID");n=t.getElementsByTagName("BBox"),n=Array.prototype.slice.call(n),n.forEach((function(e){var t=e.getElementsByTagName("Top"),n=parseFloat(t.item(0).innerHTML);t=e.getElementsByTagName("Left");var a=parseFloat(t.item(0).innerHTML);t=e.getElementsByTagName("Bottom");var o=parseFloat(t.item(0).innerHTML);t=e.getElementsByTagName("Right"),e=parseFloat(t.item(0).innerHTML),r=new s(n,a,o,e)})),V[e].forEach((function(e){e.id==o&&1==r.nK(e.bbox)&&(e.bbox=r)}))}}r.r(t);var N,w=r(2),E=r(57),M=r(14),B=r(411),A=r(34),O=r(66),j=r(1),L=r(246),F=r(6),S=null,D=null,H={},V={},C={};t["default"]={Y6:function(e){return Object(w.b)(void 0,void 0,void 0,(function(){return Object(w.d)(this,(function(){return D||(N=e,D=new Promise((function(e,t){S=new Worker(window.Core.getWorkerPath()+"contentEdit/InfixServerModule.js"),S.onmessage=function(r){b(r,e,t)},S.postMessage({cmd:"isReady"})}))),[2,D]}))}))},jga:function(e,t,r){return Object(w.b)(void 0,void 0,void 0,(function(){var n,a,o,l;return Object(w.d)(this,(function(c){switch(c.label){case 0:return i(t),H[t]=[],V[t]=[],[4,e.af([t])];case 1:return n=c.fa(),a=new TextEncoder,o=a.encode(""),l=o.buffer,S.postMessage({cmd:"exportFile",pageNumber:t,performExport:r,pdfFile:n,tableData:l},[n,l]),[2]}}))}))},jda:function(e){return Object(w.b)(void 0,void 0,void 0,(function(){var t,r,n,a,o,i,l,c;return Object(w.d)(this,(function(u){switch(u.label){case 0:return t=e.id,r=e.isText,n=e.pageNumber,a=N.getDocument(),[4,a.af([n])];case 1:return o=u.fa(),i=new TextEncoder,l=i.encode(""),c=l.buffer,S.postMessage({cmd:"deleteObject",pdfFile:o,pageNumber:n,objectID:t,isText:r,tableData:c},[c]),[2]}}))}))},Bha:function(e){return Object(w.b)(void 0,void 0,void 0,(function(){var t,r,n,a,o,i,l,c,u,s,f,m,g;return Object(w.d)(this,(function(d){switch(d.label){case 0:return t=e.id,r=e.position,n=r.top,a=r.left,o=r.bottom,i=r.right,l=e.isText,c=e.pageNumber,u=N.getDocument(),[4,u.af([c])];case 1:return s=d.fa(),f=new TextEncoder,m=f.encode(""),g=m.buffer,S.postMessage({cmd:"transformObject",pdfFile:s,pageNumber:c,objectID:t,isText:l,topVal:n,leftVal:a,bottomVal:o,rightVal:i,tableData:g},[g]),[2]}}))}))},Haa:function(e,t){return Object(w.b)(void 0,void 0,void 0,(function(){var r,n,o,i,l,c,s,f,m,g,p,b,h,y,T;return Object(w.d)(this,(function(v){switch(v.label){case 0:return r=u(t),r=r.replace(/<span style="color: var\(--text-color\);">(.*?)<\/span>/g,"$1"),n=e.bB.id,o=e.PageNumber,i=C[o],l=i.galleys.find((function(e){return e.id===n})),c=a(l.contents),s=d(o,i,c,r,n),""==s?[3,2]:(f=new TextEncoder,m=f.encode(s),g=m.buffer,p=Object(A.c)()||"https://www.pdftron.com/webfonts/v2/",b=N.getDocument(),[4,b.af([o])]);case 1:return h=v.fa(),f=new TextEncoder,y=f.encode(""),T=y.buffer,S.postMessage({cmd:"importText",pdfFile:h,pageNumber:o,webFontURL:p,galleyId:n,importData:g,tableData:T},[g,T]),[3,3];case 2:Object(j.g)("Unable to generate import XML"),v.label=3;case 3:return[2]}}))}))},n1:function(e){if(e)return a(e.contents);Object(j.g)("Unable to extract document content")}}},411:function(e,t,r){var n=r(2);e=r(69);var a=r(45);r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.c)(t,e),t.prototype.testSelection=function(e,t,r){return a.a.jj(e,t,r)},t}(e.a),t.a=r}}])}).call(this||window);