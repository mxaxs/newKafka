(function(){(window.wpCoreControlsBundle=window.wpCoreControlsBundle||[]).push([[17],{377:function(e,t,s){function n(e,t,s){t.endsWith("/")||(t+="/"),s=s||{};var n=s.disableWebsockets||!1;this.oR=s.singleServerMode||!1,null!=s.customQueryParameters&&Object(v.b)("wvsQueryParameters",s.customQueryParameters),t.endsWith("blackbox/")||(t+="blackbox/"),this.Tl=s.uploadData||null,this.Yu=s.uriData||null,this.sK=s.cacheKey||null,this.AO=s.officeOptions||null,this.ns=Object(c.a)(t,null,n),this.xe=t,this.QC=e,this.Ke=null,this.Gi=r(),this.Zk=r(),this.lx=!1,this.wf=this.pd=this.Dd=this.we=null,this.Oe=[],this.Rx=[],this.cache={},this.timeStamp=0,this.hf=[],this.tg=[],this.iD=null,this.MC=!1,this.kG=this.id=null,this.QE=this.bN=a,this.Sz=0,this.gE=!1,this.vO=1,this.ph={},this.Oo=0,this.uq=i(),this.eo(!0)}function i(){var e={Mp:{},qb:[],pop:function(){var t=e.qb.pop();return e.Mp[t.key]=void 0,t},push:function(t,s){s={key:t,data:s},e.qb.push(s),e.Mp[t]=s.data},contains:function(t){return!!e.Mp[t]},get:function(t){return e.Mp[t]},set:function(t,s){e.Mp[t]=s,e.qb.forEach((function(s,n){s.key==t&&(e.qb[n]=s)}))},remove:function(t){e.Mp[t]=void 0,e.qb.forEach((function(s,n){s.key==t&&e.qb.splice(n,1)}))},length:function(){return e.qb.length}};return e}function r(){var e={promise:null,resolve:null,reject:null,state:0,result:null,request:null,Xp:function(){return 1===(1&e.state)},C4:function(){return 2===(2&e.state)},kh:function(){return!e.C4()&&!e.Xp()},a4:function(){return 4===(4&e.state)},KQ:function(){e.state|=4}};return e.promise=new Promise((function(t,s){e.resolve=function(){0!==e.state&&4!==e.state||(e.state=1,e.result=arguments[0],t.apply(null,arguments))},e.reject=function(){0!==e.state&&4!==e.state||(e.state=2,s.apply(null,arguments))}})),e}function a(){return!1}function h(e,t,s){if(!(t in m))return!0;t=m[t];for(var n=0;n<t.length;n++){var i=e,r=t[n],a=s;if(r.name in i){var h="",u=!1;switch(i=i[r.name],r.type){case"s":h="String",u=Object(o.isString)(i);break;case"a":h="Array",u=Object(o.isArray)(i);break;case"n":h="Number",u=Object(o.isNumber)(i)&&Object(o.isFinite)(i);break;case"o":h="Object",u=Object(o.isObject)(i)&&!Object(o.isArray)(i)}u||a.reject('Expected response field "'+r.name+'" to have type '+h),r=u}else a.reject('Response missing field "'+r.name+'"'),r=!1;if(!r)return!1}return!0}s.r(t);var o=s(0);s.n(o);var u=s(1);e=s(48);var l=s(32),c=s(396),p=s(80),d=s(302),f=s(101),v=s(37),w=s(139),m={pages:[{name:"pages",type:"a"}],pdf:[{name:"url",type:"s"}],docmod:[{name:"url",type:"s"},{name:"rID",type:"s"}],health:[],tiles:[{name:"z",type:"n"},{name:"rID",type:"n"},{name:"tiles",type:"a"},{name:"size",type:"n"}],annots:[{name:"url",type:"s"},{name:"name",type:"s"}],image:[{name:"url",type:"s"},{name:"name",type:"s"},{name:"p",type:"n"}],text:[{name:"url",type:"s"},{name:"name",type:"s"},{name:"p",type:"n"}],ApString2Xod:[{name:"url",type:"s"},{name:"rID",type:"s"}]};n.prototype=Object(o.extend)(n.prototype,{WY:function(){var e=this;return new Promise((function(t,s){var n=new XMLHttpRequest;n.open("GET",e.xe+"ck"),n.withCredentials=e.Ej(),n.onreadystatechange=function(){n.readyState===XMLHttpRequest.DONE&&(200===n.status?t():s())},n.send()}))},P9:function(e,t){this.bN=e||a,this.QE=t||a},GK:function(){var e=this;return this.Zk=r(),this.Gi=r(),this.ns.$C().then((function(){return e.lx=!1,e.id=null,e.MC=!1,e.WY()}))},YF:function(){var e;for(this.bN(),this.vE(),this.we&&(this.we.kh()?this.Tf(this.we.request):this.we.Xp()&&this.QE(this.we.result.url,"pdf")&&(this.we=null,this.jQ())),this.wf&&this.wf.kh()&&this.Tf(this.wf.request),this.Dd&&this.Dd.kh()?this.Tf(this.Dd.request):this.pd&&this.pd.kh()&&this.SM(this.pd.request),e=0;e<this.hf.length;e++)this.hf[e]&&this.hf[e]&&(this.hf[e].kh()?this.Tf(this.hf[e].request):this.hf[e].Xp()&&this.QE(this.hf[e].result.url,"image")&&(this.hf[e]=null,this.Pz(Object(o.uniqueId)(),e)));for(e=0;e<this.tg.length;e++)this.tg[e]&&this.tg[e]&&this.tg[e].kh()&&!this.tg[e].a4()&&this.Tf(this.tg[e].request);for(e=0;e<this.Oe.length;e++)this.Oe[e]&&this.Oe[e].kh()&&this.Tf(this.Oe[e].request)},vE:function(e){var t=this;this.lx||(this.timeStamp=Date.now(),this.ns.NG((function(e){t.Q5(e)}),(function(){return null}),(function(){return null}),!0).then((function(){clearInterval(t.Iz),t.Iz=null}),(function(s){if(t.lx=!1,!t.Iz){var n=0;t.MC=!0,t.kG=0,t.Iz=setInterval((function(){2>n++?t.YF():(clearInterval(t.Iz),e&&e.reject(f.a),Object(u.g)("WebViewerServer connection failed:"+s))}),5e3)}})),this.lx=!0)},Oaa:function(){var e=this,t=createPromiseCapability();if(this.Tl){var s=new FormData;s.append("file",this.Tl.fileHandle,this.Tl.fileHandle.name);var n=this.Tl.loadCallback,i="upload",r=this.Tl.extension}else{if(!this.Yu)return Promise.resolve();s={uri:this.Yu.uri,oha:this.Yu.shareId},s=Object.keys(s).map((function(e){return e+"="+(s[e]?encodeURIComponent(s[e]):"")})).join("&");var a="application/x-www-form-urlencoded; charset=UTF-8";n=this.Yu.loadCallback,i="url",r=this.Yu.extension}var h=new XMLHttpRequest,o=Object(l.h)(e.xe,"AuxUpload");return o=Object(w.a)(o)+"&type="+i+"&ext="+r,h.open("POST",o),h.withCredentials=this.Ej(),a&&h.setRequestHeader("Content-Type",a),h.addEventListener("load",(function(){if(h.readyState===h.DONE&&200===h.status){var s=JSON.parse(h.response);e.QC=s.uri,n(s),t.resolve(s)}})),h.addEventListener("error",(function(){t.reject(h.statusText+" "+JSON.stringify(h))})),this.Tl&&null!=this.Tl.onProgress&&(h.upload.onprogress=function(t){e.Tl.onProgress(t)}),h.send(s),t.promise},C8:function(e){return this.password=e||null,this.Gi.Xp()||(this.Gi=r(),this.Tf({t:"pages"})),this.Gi.promise},qu:function(e){return this.iD=e||null,this.Gi.Xp()||(this.vE(this.Gi),this.Tf({t:"pages"})),this.Gi.promise},ls:function(e){return e=Object.assign(e,{uri:encodeURIComponent(this.QC)}),this.iD&&(e.ext=this.iD),this.Ke&&(e.c=this.Ke),this.password&&(e.pswd=this.password),this.sK&&(e.cacheKey=this.sK),this.AO&&(e.officeOptions=this.AO),e},j9:function(){0<this.uq.length()&&10>=this.Oo&&this.k9(this.uq.pop().data)},IX:function(e){return!!(0<this.uq.length()&&this.uq.contains(e))&&(this.uq.remove(e),!0)},Tf:function(e){e=this.ls(e),this.ns.send(e)},xQ:function(e,t){10<this.Oo?this.uq.push(e,t):(this.Oo++,e=this.ls(t),this.ns.send(e))},k9:function(e){this.Oo++,e=this.ls(e),this.ns.send(e)},qj:function(e){return e},Q5:function(e){var t=this,s=e.data,n=e.err,i=e.t;switch(i){case"upload":n?t.Paa.reject(n):t.Paa.resolve("Success");break;case"pages":n?t.Gi.reject(n):h(s,i,t.Gi)&&t.Gi.resolve(s);break;case"config":if(n)t.Zk.reject(n);else if(h(s,i,t.Zk)){if(s.id&&(t.id=s.id),s.auth){var a=Object(v.a)("wvsQueryParameters");a.auth=s.auth,Object(v.b)("wvsQueryParameters",a)}s.serverVersion&&(t.qS=s.serverVersion,Object(u.h)("[WebViewer Server] server version: "+t.qS)),s.serverID?(t.Sz=s.serverID===t.kG&&t.gE?t.Sz+1:0,t.kG=s.serverID):t.Sz=0,t.gE=!1,t.Zk.resolve(s)}break;case"health":n?t.Zk.reject(n):h(s,i,t.Zk)&&(s=s.unhealthy,t.oR&&s?Object(u.j)("Server failed health check. Single server mode ignoring check."):!t.Cda&&s&&1>=t.Sz&&(t.gE=!0,t.GK().then((function(){t.YF()}),(function(){t.YF()}))));break;case"pdf":s.url=Object(w.a)(t.xe+"../"+encodeURI(s.url)),n?t.we.reject(n):h(s,i,t.we)&&t.we.resolve(s);break;case"ApString2Xod":s.url=Object(w.a)(t.xe+"../data/"+encodeURI(s.url)),n?t.ph[s.rID].reject(n):h(s,i,t.ph[s.rID])&&t.ph[s.rID].resolve(s);break;case"docmod":s.url=Object(w.a)(t.xe+"../"+encodeURI(s.url)),n?t.ph[s.rID].reject(n):h(s,i,t.we)&&t.ph[s.rID].resolve(s);break;case"xod":n?(this.Dd&&this.Dd.kh()&&this.Dd.reject(n),this.pd&&this.pd.kh()&&this.pd.reject(n)):s.notFound?(s.noCreate||this.Dd&&this.Dd.kh()&&this.Dd.resolve(s),this.pd&&this.pd.kh()&&this.pd.resolve(s)):(s.url&&(s.url=Object(w.a)(t.xe+"../"+encodeURI(s.url))),this.pd&&!this.pd.Xp()||(this.pd=r(),this.pd.request={t:"xod",noCreate:!0}),this.Dd||(this.Dd=r(),this.Dd.request={t:"xod"}),this.pd.resolve(s),this.Dd.resolve(s));break;case"annots":if(n)t.wf.reject(n);else if(h(s,i,t.wf)){t.wf.KQ();var o=new XMLHttpRequest;a=t.xe+"../"+encodeURI(s.url);var l=s.hasAppearance?Object(w.a)(a+".xodapp"):null;o.open("GET",Object(w.a)(a)),o.responseType="text",o.withCredentials=this.Ej(),o.addEventListener("load",(function(){o.readyState===o.DONE&&200===o.status&&t.wf.resolve({lH:o.response,Ow:l})})),o.addEventListener("error",(function(){t.wf.reject(o.statusText+" "+JSON.stringify(o))})),o.send()}break;case"image":t.Oo--;var c=this.hf[s.p];n?c.promise.reject(n):h(s,i,c)&&(c.result=s,c.result.url=Object(w.a)(t.xe+"../"+encodeURI(c.result.url)),c.resolve(c.result));break;case"tiles":if(t.Oo--,c=s.rID,a=this.Oe[c],this.Oe[c]=null,this.Rx.push(c),n)a.reject(n);else if(h(s,i,a)){for(n=0;n<s.tiles.length;n++)s.tiles[n]=Object(w.a)(t.xe+"../"+encodeURI(s.tiles[n]));a.resolve(s)}break;case"text":if(c=this.tg[s.p],n)c.reject(n);else if(h(s,i,c)){c.KQ();var d=new XMLHttpRequest;s=Object(w.a)(t.xe+"../"+encodeURI(s.url)),d.open("GET",s),d.withCredentials=this.Ej(),d.addEventListener("load",(function(){d.readyState===d.DONE&&200===d.status&&(c.result=JSON.parse(d.response),c.resolve(c.result))})),d.addEventListener("error",(function(e){c.reject(d.statusText+" "+JSON.stringify(e))})),d.send()}break;case"progress":"loading"===s.t&&t.trigger(p.a.Events.DOCUMENT_LOADING_PROGRESS,[s.bytes,s.total])}this.j9(),!i&&e.echo&&e&&"apstring2xod"==e.echo.t&&(e=e.echo.reqID)&&(2<=parseInt(t.qS)?t.ph[e].reject("Message unhandled by server"):t.ph[e].reject())},aM:function(){return this.vE(this.Zk),this.Zk.promise},V0:function(e){for(var t=this,s=new XMLHttpRequest,n=Object(w.a)(this.xe+"aul")+"&id="+this.id,i=new FormData,a={},h=0;h<e.body.length;h++){var o=e.body[h];a[o.id]=o.hC.w+";"+o.hC.h,i.append(o.id,o.hC.dataString)}e={t:"apstring2xod",reqID:this.vO++,parts:a};var u=this.ls(e);return i.append("msg",JSON.stringify(u)),t.ph[u.reqID]=r(),s.open("POST",n),s.withCredentials=t.Ej,n=new Promise((function(e,t){s.onreadystatechange=function(){4===s.readyState&&(200===s.status?e():t("An error occurred while sending down appearance strings to the server"))}})),s.send(i),n.then((function(){return t.ph[u.reqID].promise}))},U0:function(){return this.wf||(this.wf=r(),this.wf.request={t:"annots"},this.Tf(this.wf.request)),this.wf.promise},Pz:function(e,t){return this.hf[t]||(this.hf[t]=r(),this.hf[t].request={t:"image",p:t},this.xQ(e,this.hf[t].request)),this.hf[t].promise},D8:function(e){return this.tg[e]||(this.tg[e]=r(),this.tg[e].request={t:"text",p:e},this.Tf(this.tg[e].request)),this.tg[e].promise},E8:function(e,t,s,n,i){var a=this.Oe.length;return this.Rx.length&&(a=this.Rx.pop()),this.Oe[a]=r(),this.Oe[a].request={t:"tiles",p:t,z:s,r:n,size:i,rID:a},this.xQ(e,this.Oe[a].request),this.Oe[a].promise},jQ:function(){return this.we||(this.we=r(),this.we.request={t:"pdf"},this.MC?this.we.resolve({url:this.QC}):this.Tf(this.we.request)),this.we.promise},tM:function(e){var t=this,s=new XMLHttpRequest,n=Object(w.a)(this.xe+"aul")+"&id="+this.id,i=new FormData,a={};e.annots&&(a.annots="xfdf"),e.watermark&&(a.watermark="png"),e.redactions&&(a.redactions="redact"),a={t:"docmod",reqID:this.vO++,parts:a},e.print&&(a.print=!0);var h=this.ls(a);return i.append("msg",JSON.stringify(h)),Promise.all([e.annots,e.watermark,e.redactions].map((function(e){return Promise.resolve(e)}))).then((function(e){var a=e[0],o=e[1],u=e[2];return a&&i.append("annots",a),o&&i.append("watermark",e.watermark),u&&i.append("redactions",u),t.ph[h.reqID]=r(),s.open("POST",n),s.withCredentials=t.Ej,e=new Promise((function(e,t){s.onreadystatechange=function(){4===s.readyState&&(200===s.status?e():t("An error occurred while sending down annotation data to the server"))}})),s.send(i),e.then((function(){return t.ph[h.reqID].promise}))}))},SM:function(){return this.pd||(this.pd=r(),this.pd.request={t:"xod",noCreate:!0},this.Tf(this.pd.request)),this.pd.promise},F8:function(){return this.Dd||(this.Dd=r(),this.Dd.request={t:"xod"},this.Tf(this.Dd.request)),this.Dd.promise},Jl:function(){return!0},request:function(){},HP:function(){},abort:function(){for(var e=0;e<this.Oe.length;e++)this.Oe[e]&&(this.Oe[e].resolve(null),this.Oe[e]=null,this.Rx.push(e));this.close()},aA:function(e){this.Ke=this.Ke||{},this.Ke.headers=e},zea:function(){return this.Ke?Object(o.omit)(this.Ke.headers,["Cookie","cookie"]):null},eo:function(e){this.Ke=this.Ke||{},this.Ke.internal=this.Ke.internal||{},this.Ke.internal.withCredentials=e},Ej:function(){return this.Ke&&this.Ke.internal?this.Ke.internal.withCredentials:null},getFileData:function(){return Promise.reject()}}),Object(e.a)(n),Object(d.a)(n),Object(d.b)(n),t["default"]=n},396:function(e,t,s){function n(e,t,s){function n(e,t){function s(e){i().then((function(t){d&&!f?setTimeout((function(){s(e)}),1):t.send(JSON.stringify(e))}))}function n(e,t,n,i){var m=window.createPromiseCapability(),b=!1,O=m;o=e,u=t,p=n,c=null,i&&(e=Object(a.a)("wvsQueryParameters"),e.bcid=Object(r.i)(8),Object(a.b)("wvsQueryParameters",e));try{e=v?w+"/"+v:w+"/ws",e=Object(h.a)(e);var g=new WebSocket(e);g.onopen=function(){m.resolve(),b=!0,m=null,d=!1,l.resolve(g),u&&u()},g.onerror=function(e){d=f=!0,m&&m.reject(e),c&&c.reject()},g.onclose=function(){l=window.createPromiseCapability(),d=!0,c||(c=window.createPromiseCapability()),c.resolve(),p&&p(),o&&b&&o({t:"health",data:{unhealthy:!0,isDead:!0}})},g.onmessage=function(e){e&&e.data&&(e=JSON.parse(e.data),e.hb?s({hb:!0}):e.end?close():o(e))}}catch(j){m.reject(j),m=null}return O.promise}function i(){return d&&o&&n(o),l.promise}var o,u,l=window.createPromiseCapability(),c=null,p=null,d=!1,f=!1,v=t,w=function(e){var t=e.indexOf("://"),s="ws://";0>t?t=0:(5===t&&(s="wss://"),t+=3);var n=e.lastIndexOf("/");return 0>n&&(n=e.length),s+e.slice(t,n)}(e);return{send:s,NG:n,$C:function(){return c?c.promise:i().then((function(e){return c=window.createPromiseCapability(),o=null,e.close(),c.promise}))}}}function o(e){var t=e.lastIndexOf("/");return 0>t&&(t=e.length),e.slice(0,t)}return window.WebSocket&&!s?n(e,t):function(e,t){function s(e){(p?p.promise:Promise.resolve(c)).then((function(t){var s=new XMLHttpRequest,n=l?u+"/"+l+"pf":u+"/pf";n=Object(h.a)(n)+"&id="+t,t=new FormData,t.append("data",JSON.stringify(e)),s.open("POST",n),s.withCredentials=!0,s.send(t)}))}function n(){c=0,p||(p=window.createPromiseCapability())}function r(){a=new XMLHttpRequest;var e=u+"/pf";e+=0!==c?"?id="+c+"&uc="+w:"?uc="+w,w++,a.open("GET",e,!0),a.withCredentials=!0,a.setRequestHeader("Cache-Control","no-cache"),a.setRequestHeader("X-Requested-With","XMLHttpRequest");var t=a,h=!1;a.onreadystatechange=function(){e:if(3<=t.readyState&&!h){try{var e=t.responseText.length}catch(u){Object(i.h)("caught exception");break e}if(0<e)try{var a,o=t.responseText.split("\n");for(o[o.length-1]&&o.pop();0<o.length&&3>o[o.length-1].length;)"]"===o.pop()&&n();for(0<o.length&&3>o[0].length&&o.shift(),e=0;e<o.length;++e)o[e].endsWith(",")&&(o[e]=o[e].substr(0,o[e].length-1));for(0===c&&0<o.length&&(c=JSON.parse(o.shift()).id,e=p,p=null,e.resolve(c)),e=0;e<o.length;++e)(a=JSON.parse(o[e]))&&a.end?close():a&&a.hb&&a.id===c?s({hb:!0}):v(a)}catch(u){}d||(h=!0,r())}},a.send()}var a,u=o(e),l=t,c=0,p=window.createPromiseCapability(),d=!1,f=null,v=null,w=0;return{send:s,NG:function(e,t,s){return v=e,f=s,d=!1,n(),r(),t&&t(),Promise.resolve()},$C:function(){return n(),v=null,d=!0,f&&f(),a.abort(),Promise.resolve()}}}(e,t)}s.d(t,"a",(function(){return n}));var i=s(1),r=s(32),a=s(37),h=s(139)}}])}).call(this||window);